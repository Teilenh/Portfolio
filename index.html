<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My projects</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background-color: #000;
            color: #00ff00;
            overflow-x: hidden;
            height: 100vh;
            cursor: text;
        }

        .terminal {
            width: 100%;
            height: 100vh;
            padding: 20px;
            overflow-y: auto;
            position: relative;
        }

        .terminal-header {
            color: #00ff00;
            margin-bottom: 20px;
            font-size: 14px;
            line-height: 1.4;
        }

        .output-line {
            margin-bottom: 5px;
            word-wrap: break-word;
            white-space: pre-wrap;
        }

        .prompt {
            color: #00ff00;
        }

        .command {
            color: #ffffff;
        }

        .input-line {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .prompt-text {
            color: #00ff00;
            margin-right: 5px;
        }

        .command-input {
            background: transparent;
            border: none;
            color: #ffffff;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            outline: none;
            flex: 1;
            caret-color: #00ff00;
        }

        .cursor {
            display: inline-block;
            background-color: #00ff00;
            width: 8px;
            height: 16px;
            animation: blink 1s infinite;
            margin-left: 2px;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .error {
            color: #ff4444;
        }

        .success {
            color: #44ff44;
        }

        .info {
            color: #4444ff;
        }

        .warning {
            color: #ffff44;
        }

        /* Mobile optimizations */
        @media (max-width: 768px) {
            .terminal {
                padding: 10px;
            }
            
            body {
                font-size: 12px;
            }
        }

        /* Scrollbar styling */
        .terminal::-webkit-scrollbar {
            width: 8px;
        }

        .terminal::-webkit-scrollbar-track {
            background: #000;
        }

        .terminal::-webkit-scrollbar-thumb {
            background: #00ff00;
            border-radius: 4px;
        }

        .terminal::-webkit-scrollbar-thumb:hover {
            background: #00cc00;
        }

        /* File listing styles */
        .file-list {
            margin: 10px 0;
        }

        .file-item {
            display: inline-block;
            margin-right: 20px;
            margin-bottom: 5px;
            min-width: 150px;
        }

        .directory {
            color: #4444ff;
            font-weight: bold;
        }

        .executable {
            color: #44ff44;
            font-weight: bold;
        }

        /* ASCII Art */
        .ascii-art {
            color: #00ff00;
            font-size: 12px;
            line-height: 1.2;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="terminal" id="terminal">
        <div class="terminal-header">
            <pre class="ascii-art">
╔══════════════════════════════════════════════════════════════════════════════╗
║                           TERMINAL PORTFOLIO v1.0                            ║
║                              Linux Enthusiast                                ║
╚══════════════════════════════════════════════════════════════════════════════╝
            </pre>
            <div>Tapez 'help' pour commencer.</div>
            <div>Système : Simulation of Linux CLI </div>
            <div>Utilisateur : guest@portfolio</div>
            <div>─────────────────────────────────────────────────────────────────────────────</div>
        </div>
        
        <div id="output"></div>
        
        <div class="input-line">
            <span class="prompt-text">guest@portfolio:~$ </span>
            <input type="text" class="command-input" id="commandInput" autofocus>
            <span class="cursor"></span>
        </div>
    </div>

    <script>
        // ===== SYSTÈME DE MODULES DE COMMANDES =====
        
        // Classe de base pour les commandes
        class Command {
            constructor(name, description) {
                this.name = name;
                this.description = description;
            }
            
            execute(args, terminal) {
                throw new Error('La méthode execute() doit être implémentée');
            }
        }
        
        // ===== MODULES DE COMMANDES =====
        
        // Module: Commandes système
        class SystemCommands {
            static getCommands() {
                return [
                    new class extends Command {
                        constructor() { super('whoami', 'Affiche l\'utilisateur actuel'); }
                        execute(args, terminal) {
                            terminal.displayOutput('guest');
                        }
                    },
                    
                    new class extends Command {
                        constructor() { super('pwd', 'Affiche le répertoire actuel'); }
                        execute(args, terminal) {
                            terminal.displayOutput(terminal.currentDirectory);
                        }
                    },
                    
                    new class extends Command {
                        constructor() { super('uname', 'Informations système'); }
                        execute(args, terminal) {
                            terminal.displayOutput('Linux 6.16.8.0-portfolio #1 SMP Web Terminal x86_64 GNU/Linux');
                        }
                    },
                    
                    new class extends Command {
                        constructor() { super('date', 'Affiche la date actuelle'); }
                        execute(args, terminal) {
                            terminal.displayOutput(new Date().toString());
                        }
                    },
                    
                    new class extends Command {
                        constructor() { super('uptime', 'Temps de fonctionnement'); }
                        execute(args, terminal) {
                            const uptime = Math.floor((Date.now() - terminal.startTime) / 1000);
                            const minutes = Math.floor(uptime / 60);
                            const seconds = uptime % 60;
                            terminal.displayOutput(`up ${minutes} minutes, ${seconds} seconds`);
                        }
                    },
                    
                    new class extends Command {
                        constructor() { super('clear', 'Efface l\'écran'); }
                        execute(args, terminal) {
                            terminal.output.innerHTML = '';
                        }
                    }
                ];
            }
        }
        
        // Module: Commandes de fichiers
        class FileCommands {
            static getCommands() {
                return [
                    new class extends Command {
                        constructor() { super('ls', 'Liste les fichiers et dossiers'); }
                        execute(args, terminal) {
                            const path = args[0] || terminal.currentDirectory;
                            const resolved = terminal.resolvePath(path);
                            const item = terminal.getFileSystemItem(resolved);

                            if (!item) {
                                terminal.displayOutput(`ls: cannot access '${path}': No such file or directory`, 'error');
                                return;
                            }

                            if (item.type === 'file') {
                                terminal.displayOutput(path);
                                return;
                            }

                            const files = Object.keys(item.contents || {});
                            if (files.length === 0) {
                                terminal.displayOutput('(répertoire vide)');
                                return;
                            }

                            let output = '<div class="file-list">';
                            files.forEach(file => {
                                const fileItem = item.contents[file];
                                let className = '';
                                let suffix = '';
                                
                                if (fileItem.type === 'directory') {
                                    className = 'directory';
                                    suffix = '/';
                                } else if (file.endsWith('.sh') || file.endsWith('.py')) {
                                    className = 'executable';
                                    suffix = '*';
                                }
                                
                                output += `<span class="file-item ${className}">${file}${suffix}</span>`;
                            });
                            output += '</div>';
                            
                            terminal.displayHTML(output);
                        }
                    },
                    
                    new class extends Command {
                        constructor() { super('cat', 'Affiche le contenu d\'un fichier'); }
                        execute(args, terminal) {
                            if (args.length === 0) {
                                terminal.displayOutput('cat: missing file operand', 'error');
                                return;
                            }

                            const path = args[0];
                            const resolved = terminal.resolvePath(path);
                            const item = terminal.getFileSystemItem(resolved);

                            if (!item) {
                                terminal.displayOutput(`cat: ${path}: No such file or directory`, 'error');
                                return;
                            }

                            if (item.type === 'directory') {
                                terminal.displayOutput(`cat: ${path}: Is a directory`, 'error');
                                return;
                            }

                            const content = item.content || 'Fichier vide';
                            content.split('\n').forEach(line => {
                                terminal.displayOutput(line);
                            });
                        }
                    },
                    
                    new class extends Command {
                        constructor() { super('cd', 'Change de répertoire'); }
                        execute(args, terminal) {
                            const path = args[0] || '~';
                            const resolved = terminal.resolvePath(path);
                            const item = terminal.getFileSystemItem(resolved);

                            if (!item) {
                                terminal.displayOutput(`cd: ${path}: No such file or directory`, 'error');
                                return;
                            }

                            if (item.type !== 'directory') {
                                terminal.displayOutput(`cd: ${path}: Not a directory`, 'error');
                                return;
                            }

                            terminal.currentDirectory = resolved;
                        }
                    }
                ];
            }
        }
        
        // Module: Commandes portfolio
        class PortfolioCommands {
            static getCommands() {
                return [
                    new class extends Command {
                        constructor() { super('about', 'À propos de moi'); }
                        execute(args, terminal) {
                            terminal.displayOutput('À propos de moi', 'success');
                            terminal.displayOutput('');
                            terminal.displayOutput('Passionné par Linux et le jeux vidéos,');
                            terminal.displayOutput('j\'explore les technologies de l\'open source. en Utilise certaine, et joue avec les composante de mon systéme linux');
                            terminal.displayOutput('');
                            terminal.displayOutput('J\'apprends:');
                            terminal.displayOutput('• Administration système Linux');
                            terminal.displayOutput('• Développement Python (Qt6 pour l\'aspect graphique, la base)');
                            terminal.displayOutput('• Auto-hébergement et home server, hébergement d\'un Pihole et de SearXNG');
                            terminal.displayOutput('• Personnalisation et optimisation système, avec l\'usage d\'Alpine linux au quotidien, son optimisation et l\'usage du TWM Sway,');
                            terminal.displayOutput('');
                            terminal.displayOutput('Tapez "cat README.md" pour plus d\'informations.', 'info');
                        }
                    },
                    
                    new class extends Command {
                        constructor() { super('projects', 'Mes projets'); }
                        execute(args, terminal) {
                            terminal.displayOutput('Mes projets principaux', 'success');
                            terminal.displayOutput('');
                            terminal.displayOutput('1. Home Server Personnel');
                            terminal.displayOutput('   Infrastructure auto-hébergée avec services multiples');
                            terminal.displayOutput('');
                            terminal.displayOutput('2. Linux Ricing & Configurations');
                            terminal.displayOutput('   Personnalisation avancée d\'environnements Linux, TWM et DE');
                            terminal.displayOutput('');
                            terminal.displayOutput('3. PyKemon - Jeu Python Qt6');
                            terminal.displayOutput('   Application de jeu avec interface graphique moderne et "old school" avec Tkinter');
                            terminal.displayOutput('');
                            terminal.displayOutput('Utilisez "ls projects" et "cat projects/*" pour plus de détails.', 'info');
                        }
                    },
                    
                    new class extends Command {
                        constructor() { super('contact', 'Informations de contact'); }
                        execute(args, terminal) {
                            terminal.displayOutput('Informations de contact', 'success');
                            terminal.displayOutput('');
                            terminal.displayOutput('GitHub: https://github.com/teilenh');
                            terminal.displayOutput('');
                        }
                    }
                ];
            }
        }
        
        // Module: Easter eggs
        class EasterEggCommands {
            static getCommands() {
                return [
                    new class extends Command {
                        constructor() { super('sudo', 'élévation de priviléges'); }
                        // utilitaire d'affichage séquentiel (léger délai pour réalisme)
                        printLines(terminal, lines, delay = 120, callback) {
                            let i = 0;
                            const step = () => {
                                if (i >= lines.length) {
                                    if (typeof callback === 'function') callback();
                                    return;
                                }
                                terminal.displayOutput(lines[i]);
                                i++;
                                setTimeout(step, delay);
                            };
                            step();
                        }
                        execute(args, terminal) {
                            const user = terminal.user || 'guest';
        
                            // si pas d'arguments : afficher usage doas
                            if (!args || args.length === 0) {
                                terminal.displayOutput('usage: doas [-Lns] [-C config] [-u user] command [args]', 'info');
                                return;
                            }
        
                            const command = args.join(' ').trim();
        
                            // motifs dangereux
                            const dangerous = [
                                /(^|\s)rm\s+-rf\s+\/(\s|$|;)/i,
                                /(^|\s)dd\s+if=/i,
                                /(^|\s)mkfs(\.|\s|$)/i,
                                /:\(\)\s*{\s*:.*}\s*;:\s*/i, // fork-bomb
                                /(^|\s)wget\s+.*sh(\s|$)/i
                            ];
        
                            if (dangerous.some(rx => rx.test(command))) {
                                terminal.displayOutput(`sudo: ${command}: operation not permitted`, 'error');
                                return;
                            }
        
                            // cas général : utilisateur non autorisé
                            terminal.displayOutput(`${user} is not in the sudoers file.  This incident will be reported.`, 'error');
                        }
                    }
                ];
            }
        }
                               
        // Module: Commande help (spéciale car elle doit connaître toutes les commandes)
        class HelpCommand extends Command {
            constructor() { 
                super('help', 'Affiche la liste des commandes disponibles'); 
            }
            
            execute(args, terminal) {
                terminal.displayOutput('Commandes disponibles:', 'success');
                terminal.displayOutput('');
                for (const [cmd, command] of Object.entries(terminal.commands)) {
                    terminal.displayOutput(`  ${cmd.padEnd(12)} - ${command.description}`);
                }
                terminal.displayOutput('');
                terminal.displayOutput('Utilisez les flèches haut/bas pour naviguer dans l\'historique.', 'info');
            }
        }

        class Terminal {
            constructor() {
                this.output = document.getElementById('output');
                this.input = document.getElementById('commandInput');
                this.terminal = document.getElementById('terminal');
                this.commandHistory = [];
                this.historyIndex = -1;
                this.currentDirectory = '~';
                
                this.loadCommands();
                this.initializeFileSystem();
                this.setupEventListeners();
            }

            loadCommands() {
                this.commands = {};
                
                // Charger tous les modules de commandes
                const commandModules = [
                    SystemCommands,
                    FileCommands,
                    PortfolioCommands,
                    EasterEggCommands
                ];
                
                // Enregistrer toutes les commandes
                commandModules.forEach(module => {
                    module.getCommands().forEach(command => {
                        this.registerCommand(command);
                    });
                });
                
                // Ajouter la commande help en dernier (elle a besoin de connaître toutes les commandes)
                this.registerCommand(new HelpCommand());
            }
            
            registerCommand(command) {
                this.commands[command.name] = command;
            }

            initializeFileSystem() {

                this.startTime = Date.now();
                
                this.fileSystem = {
                    '~': {
                        type: 'directory',
                        contents: {
                            'README.md': {
                                type: 'file',
                                content: `# Portfolio Terminal

Bienvenue sur mon portfolio interactif !

## Navigation
- Utilisez 'help' pour voir toutes les commandes
- Tapez 'about' pour en savoir plus sur moi
- Tapez 'projects' pour voir mes projets
- Tapez 'skills' pour mes compétences ( WIP, cmd non existante ) 

## Projets principaux
- Home Server personnel, PiHole, SearXNG, dans le futur Gitea, NTP et d'autre service
- Configurations Linux (ricing, optimisation)

Bonne exploration !`
                            },
                            'projects': {
                                type: 'directory',
                                contents: {
                                    'homeserver.txt': {
                                        type: 'file',
                                        content: `# Home Server Project

Description: Serveur personnel auto-hébergé
Technologies: Linux, podman/distrobox, Nginx
Fonctionnalités:
- Hébergement web ( a venir, pour remplacé github pages )
- Stockage cloud personnel
- PiHole, petit service deblocage de tracker et permet du firewalling trés simplefier
- Monitoring système
- SearXNG, un metamoteur de recherche auto héberger

Status: En cours de développement`
                                    },
                                    'linux-ricing.txt': {
                                        type: 'file',
                                        content: `# Linux Ricing & Configurations

Description: Personnalisation avancée d'environnements Linux
Technologies: TWM, avec : Sway/Hyprland, Waybar, rofi, zsh, 
Fonctionnalités:
- Thèmes personnalisés
- Scripts pour capture d'écran, clipboard, gamemode, gestion des thémes, etc
- Configurations dotfiles
- Optimisations système

Github : https://github.com/Teilenh/Dotfiles-sway et https://github.com/Teilenh/Fastfetch-personalisation
Status: Maintenance continue`
                                    },
                                    'pykemon.txt': {
                                        type: 'file',
                                        content: `# PyKemon - Jeu Python Qt6

Description: Jeu inspiré de Pokémon en Python
Technologies: Python, Qt6,
Fonctionnalités:
- Interface graphique moderne et "old School"
- Système de combat
- Gestion d'équipes, et sauvegarde des équipe au sein d'un fichier

Github : https://github.com/Teilenh/PyKemon
Status: Prototype fonctionnel`
                                    }
                                }
                            },
                            'skills': {
                                type: 'directory',
                                contents: {
                                    'languages.txt': {
                                        type: 'file',
                                        content: `# Langages de programmation


## En apprentissage
- Python (débutant - intermédiaire)
- HTML/CSS (débutant - intermédiaire)

Lien vers les différents projet : 
premier petit projets :https://github.com/Teilenh/Anagramme-python
projets principal en python : https://github.com/Teilenh/PyKemon`
                                    }
                                }
                            }
                        }
                    }
                };
            }

            setupEventListeners() {
                // Focus sur le terminal au clic
                this.terminal.addEventListener('click', () => {
                    this.input.focus();
                });

                // Gestion des touches
                this.input.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') {
                        this.executeCommand();
                    } else if (e.key === 'ArrowUp') {
                        e.preventDefault();
                        this.navigateHistory(-1);
                    } else if (e.key === 'ArrowDown') {
                        e.preventDefault();
                        this.navigateHistory(1);
                    } else if (e.key === 'Tab') {
                        e.preventDefault(); // empêcher le focus sur le prochain élément
                        this.handleAutocomplete();
                    }
                });

                // Maintenir le focus
                this.input.addEventListener('blur', () => {
                    setTimeout(() => this.input.focus(), 100);
                });

                // Auto-focus initial
                this.input.focus();
            }

            executeCommand() {
                const command = this.input.value.trim();
                if (command === '') return;

                this.addToHistory(command);
                this.displayCommand(command);
                this.processCommand(command);
                this.input.value = '';
            }

            addToHistory(command) {
                this.commandHistory.push(command);
                this.historyIndex = this.commandHistory.length;
            }

            navigateHistory(direction) {
                if (this.commandHistory.length === 0) return;

                this.historyIndex += direction;
                if (this.historyIndex < 0) this.historyIndex = 0;
                if (this.historyIndex >= this.commandHistory.length) {
                    this.historyIndex = this.commandHistory.length;
                    this.input.value = '';
                } else {
                    this.input.value = this.commandHistory[this.historyIndex];
                }
            }
            handleAutocomplete() {
                const input = this.input.value.trim();
                if (input === '') return;
            
                const matchingCommands = Object.keys(this.commands).filter(cmd => cmd.startsWith(input));
            
                if (matchingCommands.length === 1) {
                    // une seule correspondance → compléter automatiquement
                    this.input.value = matchingCommands[0] + ' ';
                } else if (matchingCommands.length > 1) {
                    // plusieurs correspondances → afficher les options
                    this.displayOutput(matchingCommands.join('    '), 'info');
                }
            }
            displayCommand(command) {
                const line = document.createElement('div');
                line.className = 'output-line';
                line.innerHTML = `<span class="prompt">guest@portfolio:${this.currentDirectory}$</span> <span class="command">${command}</span>`;
                this.output.appendChild(line);
                this.scrollToBottom();
            }

            processCommand(command) {
                const parts = command.split(' ');
                const cmd = parts[0].toLowerCase();
                const args = parts.slice(1);

                if (this.commands[cmd]) {
                    this.commands[cmd].execute(args, this);
                } else {
                    this.displayOutput(`bash: ${cmd}: command not found`, 'error');
                }
            }

            displayOutput(text, className = '') {
                const line = document.createElement('div');
                line.className = `output-line ${className}`;
                line.textContent = text;
                this.output.appendChild(line);
                this.scrollToBottom();
            }

            displayHTML(html) {
                const line = document.createElement('div');
                line.className = 'output-line';
                line.innerHTML = html;
                this.output.appendChild(line);
                this.scrollToBottom();
            }

            scrollToBottom() {
                this.terminal.scrollTop = this.terminal.scrollHeight;
            }

            // Utilitaires pour le système de fichiers
            resolvePath(path) {
                if (path.startsWith('/')) {
                    return path;
                }
                if (path === '~' || path === '') {
                    return '~';
                }
                if (path.startsWith('~/')) {
                    return path;
                }
                return this.currentDirectory === '~' ? `~/${path}` : `${this.currentDirectory}/${path}`;
            }

            getFileSystemItem(path) {
                const parts = path.split('/').filter(p => p !== '');
                let current = this.fileSystem['~'];
                
                if (parts.length === 0 || (parts.length === 1 && parts[0] === '~')) {
                    return current;
                }

                // Supprimer le ~ du début
                if (parts[0] === '~') {
                    parts.shift();
                }

                for (const part of parts) {
                    if (!current.contents || !current.contents[part]) {
                        return null;
                    }
                    current = current.contents[part];
                }

                return current;
            }
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', () => {
            new Terminal();
        });
    </script>
</body>
</html>
